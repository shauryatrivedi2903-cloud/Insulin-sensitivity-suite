<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Insulin Sensitivity Suite</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  :root{
    --bg:#f3f4f6;--card:#ffffff;--border:#e3e6eb;
    --text:#1f2937;--muted:#6b7280;--accent:#16827a;
    --ok:#198754;--warn:#d39e00;--risk:#dc3545;
    --badge-ok:#d1e7dd;--badge-warn:#fff3cd;--badge-risk:#f8d7da;
  }
  body{background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,sans-serif;}
  .container-narrow{max-width:960px}
  .header-bar{
    background:linear-gradient(180deg,#fafafa 0%,#f1f3f6 100%);
    border:1px solid var(--border);border-radius:14px;padding:16px 18px;
    box-shadow:0 2px 6px rgba(0,0,0,.03);
  }
  .header-title{font-size:1.3rem;font-weight:700;margin:0;color:var(--accent);}
  .header-sub{font-size:.92rem;color:var(--muted);}
  .jump-btn{background:var(--accent);color:#fff;border:none;font-weight:600;
    border-radius:999px;padding:.45rem .95rem;box-shadow:0 6px 14px rgba(22,130,122,.2);}
  .card{background:var(--card);border:1px solid var(--border);
    border-radius:14px;box-shadow:0 1px 4px rgba(0,0,0,.03);}
  .section-title{font-weight:700;color:var(--accent);margin-bottom:.5rem;}
  .result-list{list-style:none;padding:0;margin:0;}
  .result-list li{display:flex;justify-content:space-between;align-items:center;
    border:1px solid var(--border);border-radius:12px;padding:.6rem .8rem;margin:.4rem 0;}
  .label{font-weight:600;color:var(--accent);}
  .value{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;}
  .badge-int{font-size:.8rem;font-weight:600;border-radius:10px;padding:.2rem .6rem;color:#212529;}
  .ok{background:var(--badge-ok);color:var(--ok);}
  .border{background:var(--badge-warn);color:var(--warn);}
  .bad{background:var(--badge-risk);color:var(--risk);}
  .footer-note{font-size:.85rem;color:var(--muted);}
  .table th{color:var(--accent);}
  .input-group-text{background:#eef2f7;border-color:var(--border);}
  .form-control:focus{border-color:#8fd4ce;box-shadow:0 0 0 .2rem rgba(22,130,122,.15);}
</style>
</head>
<body>
<div class="container container-narrow my-3 my-sm-4">

  <div class="header-bar d-flex align-items-center justify-content-between flex-wrap">
    <div>
      <h1 class="header-title">Insulin Sensitivity Suite</h1>
      <div class="header-sub">HOMA-IR • HOMA-β • QUICKI • Matsuda • ISI(0,120)</div>
    </div>
    <button id="scrollResults" class="jump-btn mt-2 mt-sm-0">View Results ↓</button>
  </div>

  <!-- Fasting section -->
  <div class="card p-3 p-sm-4 mt-3 mb-3">
    <div class="section-title">Fasting Values</div>
    <div class="row g-3">
      <div class="col-12 col-sm-6">
        <label class="form-label">Fasting glucose</label>
        <div class="input-group">
          <input id="fg" type="number" class="form-control" inputmode="decimal" placeholder="e.g., 92">
          <span class="input-group-text">mg/dL</span>
        </div>
      </div>
      <div class="col-12 col-sm-6">
        <label class="form-label">Fasting insulin</label>
        <div class="input-group">
          <input id="fi" type="number" class="form-control" inputmode="decimal" placeholder="e.g., 10">
          <span class="input-group-text">µU/mL</span>
        </div>
      </div>
    </div>
  </div>

  <!-- OGTT section -->
  <div class="card p-3 p-sm-4 mb-3">
    <div class="d-flex justify-content-between align-items-center mb-2 flex-wrap">
      <div class="section-title mb-0">OGTT Values (Optional)</div>
      <div>
        <button id="copyFasting" class="btn btn-sm btn-outline-secondary">Copy fasting → 0′</button>
        <button id="clearOGTT" class="btn btn-sm btn-outline-secondary">Clear OGTT</button>
      </div>
    </div>
    <div class="form-check form-switch mb-3">
      <input class="form-check-input" type="checkbox" id="enableISI">
      <label class="form-check-label" for="enableISI">Enable ISI(0,120) calculation</label>
    </div>
    <div class="row g-3">
      <div class="col-6 col-md-3"><label class="form-label">Glucose 0′</label><input id="g0" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Insulin 0′</label><input id="i0" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Glucose 30′</label><input id="g30" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Insulin 30′</label><input id="i30" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Glucose 60′</label><input id="g60" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Insulin 60′</label><input id="i60" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Glucose 90′</label><input id="g90" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Insulin 90′</label><input id="i90" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Glucose 120′</label><input id="g120" type="number" class="form-control" inputmode="decimal"></div>
      <div class="col-6 col-md-3"><label class="form-label">Insulin 120′</label><input id="i120" type="number" class="form-control" inputmode="decimal"></div>
    </div>
  </div>

  <!-- Results -->
  <div id="results" class="card p-3 p-sm-4 mb-3">
    <div class="section-title">Results & Interpretation</div>
    <ul id="resultList" class="result-list"></ul>
  </div>

  <!-- Footer Reference -->
  <div class="card p-3 p-sm-4 mb-3">
    <div class="section-title">Reference Ranges & Explanation</div>
    <div class="table-responsive">
      <table class="table table-sm align-middle mb-2">
        <thead><tr><th>Index</th><th>Normal</th><th>Borderline/Impaired</th><th>Insulin-Resistant</th></tr></thead>
        <tbody>
          <tr><td><strong>HOMA-IR</strong></td><td>&lt;2.0</td><td>2.0–2.5</td><td>&gt;2.5</td></tr>
          <tr><td><strong>HOMA-β (%)</strong></td><td>60–140</td><td>—</td><td>&lt;60 or &gt;140</td></tr>
          <tr><td><strong>QUICKI</strong></td><td>&gt;0.33</td><td>0.30–0.33</td><td>&lt;0.30</td></tr>
          <tr><td><strong>Matsuda Index</strong></td><td>&gt;4.0</td><td>2.5–4.0</td><td>&lt;2.5</td></tr>
          <tr><td><strong>ISI(0,120)</strong></td><td>&gt;4.3</td><td>2.9–4.3</td><td>&lt;2.9</td></tr>
        </tbody>
      </table>
    </div>
    <div class="footer-note">
      <b>HOMA-IR</b>: fasting estimate of hepatic insulin resistance.<br>
      <b>HOMA-β</b>: fasting β-cell function (% of typical).<br>
      <b>QUICKI</b>: fasting insulin sensitivity (higher = more sensitive).<br>
      <b>Matsuda Index</b>: OGTT-derived whole-body sensitivity.<br>
      <b>ISI(0,120)</b>: simplified OGTT insulin sensitivity (0′ & 120′ only).<br>
      Thresholds approximate adult ranges; interpret contextually.
    </div>
  </div>

  <p class="footer-note text-center mt-2">© 2025 — Insulin Sensitivity Suite. No data stored.</p>
</div>

<script>
(function(){
  const fg=document.getElementById('fg'),fi=document.getElementById('fi');
  const gEls=['g0','g30','g60','g90','g120'].map(id=>document.getElementById(id));
  const iEls=['i0','i30','i60','i90','i120'].map(id=>document.getElementById(id));
  const enableISI=document.getElementById('enableISI');
  const list=document.getElementById('resultList');
  const scrollBtn=document.getElementById('scrollResults');
  const val=e=>parseFloat(e.value)||null, pos=v=>v&&v>0;

  function makeRow(label,valtxt,state){
    const li=document.createElement('li');
    li.innerHTML=`<span class="label">${label}</span>
      <span><span class="value">${valtxt}</span> 
      <span class="badge-int ${state.cls}">${state.txt}</span></span>`;
    list.appendChild(li);
  }
  function stateHOMAIR(v){if(!pos(v))return{txt:'—',cls:''};
    if(v<2)return{txt:'Normal',cls:'ok'};
    if(v<=2.5)return{txt:'Borderline',cls:'border'};
    return{txt:'Resistant',cls:'bad'};}
  function stateHOMAB(v){if(!pos(v))return{txt:'—',cls:''};
    if(v<60)return{txt:'Decreased',cls:'bad'};
    if(v<=140)return{txt:'Normal',cls:'ok'};
    return{txt:'High',cls:'border'};}
  function stateQUICKI(v){if(!pos(v))return{txt:'—',cls:''};
    if(v>0.33)return{txt:'Normal',cls:'ok'};
    if(v>=0.30)return{txt:'Borderline',cls:'border'};
    return{txt:'Resistant',cls:'bad'};}
  function stateMatsuda(v){if(!pos(v))return{txt:'—',cls:''};
    if(v>4)return{txt:'Normal',cls:'ok'};
    if(v>=2.5)return{txt:'Impaired',cls:'border'};
    return{txt:'Resistant',cls:'bad'};}
  function stateISI(v){if(!pos(v))return{txt:'—',cls:''};
    if(v>4.3)return{txt:'Normal',cls:'ok'};
    if(v>=2.9)return{txt:'Impaired',cls:'border'};
    return{txt:'Resistant',cls:'bad'};}

  function compute(){
    list.innerHTML='';
    const g=val(fg),i=val(fi);
    if(pos(g)&&pos(i)){
      const hIR=(i*g)/405;makeRow('HOMA-IR:',hIR.toFixed(2),stateHOMAIR(hIR));
      const gmmol=g/18;if(gmmol>3.5){const hB=(20*i)/(gmmol-3.5);makeRow('HOMA-β (%):',hB.toFixed(1),stateHOMAB(hB));}
      const q=1/(Math.log10(i)+Math.log10(g));makeRow('QUICKI:',q.toFixed(3),stateQUICKI(q));
    }
    const G=gEls.map(val),I=iEls.map(val);
    if(G.every(pos)&&I.every(pos)&&pos(g)&&pos(i)){
      const Gm=G.reduce((a,b)=>a+b,0)/G.length,Im=I.reduce((a,b)=>a+b,0)/I.length;
      const m=10000/Math.sqrt((g*i)*(Gm*Im));makeRow('Matsuda Index:',m.toFixed(2),stateMatsuda(m));
    }
    if(enableISI.checked){
      const g0=val(gEls[0]),i0=val(iEls[0]),g120=val(gEls[4]),i120=val(iEls[4]);
      if([g0,i0,g120,i120].every(pos)){
        const isi=10000/Math.sqrt((g0*i0)*(g120*i120));makeRow('ISI(0,120):',isi.toFixed(2),stateISI(isi));
      }
    }
    if(!list.innerHTML)list.innerHTML='<li><em>No sufficient data to compute indices yet.</em></li>';
  }
  document.querySelectorAll('input').forEach(el=>{
    el.addEventListener('input',compute);
    el.addEventListener('focus',e=>{e.target.scrollIntoView({block:'center'});});
  });
  document.getElementById('copyFasting').onclick=()=>{document.getElementById('g0').value=fg.value;document.getElementById('i0').value=fi.value;compute();};
  document.getElementById('clearOGTT').onclick=()=>{gEls.forEach(e=>e.value='');iEls.forEach(e=>e.value='');compute();};
  scrollBtn.onclick=()=>document.getElementById('results').scrollIntoView({behavior:'smooth'});
  compute();
})();
</script>
</body>
</html>
